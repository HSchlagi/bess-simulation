<!-- Vereinfachte Navigation -->
<nav class="bg-slate-800 text-white shadow-lg">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
            <!-- Logo -->
            <div class="flex items-center">
                <a href="{{ url_for('multi_user.dashboard') }}" class="text-xl font-bold flex items-center hover:opacity-90 transition-opacity">
                    <img src="/static/logo/phoenyra_abstract.png" alt="Phoenyra" class="h-16 w-16 mr-4 object-contain" style="max-width: 64px; max-height: 64px;">
                    <div class="flex flex-col">
                        <span class="text-lg font-bold leading-tight">Phoenyra</span>
                        <span class="text-xs text-slate-300 leading-tight">BESS Studio</span>
                    </div>
                </a>
            </div>

            <!-- Desktop Navigation - Mit Dropdown-Menüs -->
            <div class="hidden md:flex items-center space-x-1">
                <!-- PWA Install Button -->
                <button id="pwa-install-button" class="hidden bg-green-600 hover:bg-green-700 px-3 py-2 rounded-md text-sm font-medium transition-colors" title="App installieren">
                    <i class="fas fa-download mr-2"></i>Installieren
                </button>
                
                <!-- PWA Status -->
                <div id="pwa-status" class="flex items-center text-sm">
                    <div class="flex items-center text-green-500">
                        <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                        </svg>
                        Online
                    </div>
                </div>
                
                <!-- Multi-User Dashboard (Hauptdashboard) -->
                <a href="{{ url_for('multi_user.dashboard') }}" class="hover:bg-blue-700 px-3 py-2 rounded-md text-sm font-medium transition-colors bg-green-600">
                    <i class="fas fa-tachometer-alt mr-2"></i>Dashboard
                </a>

                
                <!-- Projekte Dropdown -->
                <div class="relative group">
                    <button class="hover:bg-blue-700 px-3 py-2 rounded-md text-sm font-medium flex items-center transition-colors">
                        <i class="fas fa-project-diagram mr-2"></i>Projekte
                    </button>
                    <div class="absolute left-0 mt-2 w-48 bg-white rounded-md shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 border border-gray-200">
                        <a href="{{ url_for('main.projects') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-list mr-2"></i>Alle Projekte
                        </a>
                        <a href="{{ url_for('main.new_project') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-plus mr-2"></i>Neues Projekt
                        </a>
                    </div>
                </div>

                <!-- Kunden Dropdown -->
                <div class="relative group">
                    <button class="hover:bg-blue-700 px-3 py-2 rounded-md text-sm font-medium flex items-center transition-colors">
                        <i class="fas fa-users mr-2"></i>Kunden
                    </button>
                    <div class="absolute left-0 mt-2 w-48 bg-white rounded-md shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 border border-gray-200">
                        <a href="{{ url_for('main.customers') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-list mr-2"></i>Alle Kunden
                        </a>
                        <a href="{{ url_for('main.new_customer') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-user-plus mr-2"></i>Neuer Kunde
                        </a>
                    </div>
                </div>

                <!-- Daten Dropdown -->
                <div class="relative group">
                    <button class="hover:bg-blue-700 px-3 py-2 rounded-md text-sm font-medium flex items-center transition-colors">
                        <i class="fas fa-database mr-2"></i>Daten
                    </button>
                    <div class="absolute left-0 mt-2 w-48 bg-white rounded-md shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 border border-gray-200">
                        <a href="{{ url_for('main.spot_prices') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-bolt mr-2"></i>Spot-Preise
                        </a>
                        <a href="{{ url_for('main.awattar_import_working_page') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-plug mr-2"></i>aWattar API
                        </a>
                        <a href="{{ url_for('main.live_data_dashboard') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-satellite-dish mr-2"></i>Live BESS Daten
                        </a>
                        <a href="{{ url_for('main.data_import_center') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-database mr-2"></i>Datenimport-Center
                        </a>
                        <a href="{{ url_for('main.preview_data') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-eye mr-2"></i>Datenvorschau
                        </a>
                        <a href="{{ url_for('main.use_case_manager') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-lightbulb mr-2"></i>Use Case Manager
                        </a>
                        <a href="{{ url_for('main.battery_crate_config') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-battery-three-quarters mr-2"></i>Batterie-Limits (C-Rate)
                        </a>
                        <a href="{{ url_for('export.export_center') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-download mr-2"></i>Export-Zentrum
                        </a>
                        <a href="{{ url_for('main.ml_dashboard') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-robot mr-2"></i>ML & KI Dashboard
                        </a>
                        <a href="{{ url_for('main.advanced_ml_dashboard') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-brain mr-2"></i>Advanced ML Dashboard
                        </a>
                        <a href="{{ url_for('main.mcp_dashboard') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50 rounded-b-md">
                            <i class="fas fa-robot mr-2"></i>MCP AI Dashboard
                        </a>
                    </div>
                </div>

                <!-- BESS-Analysen Dropdown -->
                <div class="relative group">
                    <button class="hover:bg-blue-700 px-3 py-2 rounded-md text-sm font-medium flex items-center transition-colors">
                        <i class="fas fa-chart-line mr-2"></i>BESS-Analysen
                    </button>
                    <div class="absolute left-0 mt-2 w-48 bg-white rounded-md shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 border border-gray-200">
                        <a href="/dispatch" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-rocket mr-2"></i>Dispatch & Redispatch
                        </a>
                        <a href="{{ url_for('advanced_dispatch.dashboard') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-microchip mr-2"></i>Advanced Dispatch & Grid Services
                        </a>
                        <a href="{{ url_for('pwa.pwa_dashboard') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-mobile-alt mr-2"></i>PWA Dashboard
                        </a>
                        <a href="{{ url_for('main.bess_simulation_enhanced') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-play mr-2"></i>BESS-Simulation
                        </a>
                        <a href="{{ url_for('main.battery_crate_config') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-battery-three-quarters mr-2"></i>C-Rate Config
                        </a>
                        <a href="{{ url_for('main.bess_peak_shaving_analysis') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-chart-bar mr-2"></i>Peak Shaving Analyse
                        </a>
                        <a href="{{ url_for('main.bess_simulation_enhanced') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50 rounded-b-md">
                            <i class="fas fa-rocket mr-2"></i>Erweiterte Simulation & Dashboard
                        </a>
                    </div>
                </div>

                <!-- Wirtschaftlichkeit Dropdown -->
                <div class="relative group">
                    <button class="hover:bg-blue-700 px-3 py-2 rounded-md text-sm font-medium flex items-center transition-colors">
                        <i class="fas fa-calculator mr-2"></i>Wirtschaftlichkeit
                    </button>
                    <div class="absolute left-0 mt-2 w-48 bg-white rounded-md shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 border border-gray-200">
                        <a href="{{ url_for('main.investment_costs') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-euro-sign mr-2"></i>Investitionskosten
                        </a>
                        <a href="{{ url_for('main.reference_prices') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-cog mr-2"></i>Referenzpreise
                        </a>
                        <a href="{{ url_for('main.economic_analysis') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-chart-line mr-2"></i>Wirtschaftlichkeitsanalyse
                        </a>
                        <a href="{{ url_for('main.bess_sizing_simple') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-battery-three-quarters mr-2"></i>BESS Sizing & Optimierung
                        </a>
                        <a href="{{ url_for('co2_tracking.co2_dashboard') }}" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-leaf mr-2"></i>CO₂-Tracking & Nachhaltigkeit
                        </a>
                        <a href="/climate/climate-dashboard" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-globe-americas mr-2"></i>Climate Impact Dashboard
                        </a>
                        <a href="/climate/green-finance-dashboard" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-chart-line mr-2"></i>Green Finance Dashboard
                        </a>
                        <a href="/climate/carbon-credits-dashboard" class="block px-4 py-2 text-gray-800 hover:bg-blue-50">
                            <i class="fas fa-certificate mr-2"></i>Carbon Credits Dashboard
                        </a>
                        <a href="/climate/co2-optimization-dashboard" class="block px-4 py-2 text-gray-800 hover:bg-blue-50 rounded-b-md">
                            <i class="fas fa-leaf mr-2"></i>CO₂-Optimierung Dashboard
                        </a>
                    </div>
                </div>



                <!-- Benutzer-Dropdown -->
                <div class="relative group">
                    <button class="hover:bg-blue-700 px-3 py-2 rounded-md text-sm font-medium flex items-center transition-colors">
                        <i class="fas fa-user mr-2"></i>office@instanet.at
                    </button>
                    <div class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg opacity-0 invisible transition-all duration-200 z-50 border border-gray-200">
                        <div class="py-1">
                            <div class="px-4 py-2 text-xs text-gray-500 border-b border-gray-100">
                                Angemeldet als
                            </div>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                office@instanet.at
                            </a>
                            <a href="{{ url_for('auth_local.profile') }}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                Benutzerinfo
                            </a>
                            <a href="{{ url_for('notifications.notification_center') }}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 relative">
                                <i class="fas fa-bell mr-2"></i>Benachrichtigungen
                                <span id="notificationBadge" class="absolute top-2 right-3 bg-red-500 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center hidden">0</span>
                            </a>
                            <a href="{{ url_for('main.help') }}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                <i class="fas fa-question-circle mr-2"></i>Hilfe & Anleitungen
                            </a>
                            {% if session.get('role') == 'admin' %}
                            <div class="border-t border-gray-100"></div>
                            <a href="{{ url_for('admin.dashboard') }}" class="block px-4 py-2 text-sm text-blue-600 hover:bg-gray-100">
                                <i class="fas fa-tachometer-alt mr-2"></i>Admin-Dashboard
                            </a>
                            <a href="{{ url_for('admin.users') }}" class="block px-4 py-2 text-sm text-blue-600 hover:bg-gray-100">
                                <i class="fas fa-users mr-2"></i>Benutzer-Verwaltung
                            </a>
                            <a href="{{ url_for('main.admin_bess_mappings') }}" class="block px-4 py-2 text-sm text-blue-600 hover:bg-gray-100">
                                <i class="fas fa-microchip mr-2"></i>BESS-Zuordnung
                            </a>
                            {% endif %}
                            <div class="border-t border-gray-100"></div>
                            <a href="{{ url_for('auth_local.logout') }}" class="block px-4 py-2 text-sm text-red-600 hover:bg-gray-100">
                                Abmelden
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mobile menu button -->
            <div class="md:hidden">
                <button id="mobile-menu-button" class="text-white hover:text-gray-300 focus:outline-none focus:text-gray-300 p-2 touch-manipulation" style="min-width: 44px; min-height: 44px;">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
        </div>

        <!-- Mobile Navigation - Mit Dropdown-Gruppen -->
        <div id="mobile-menu" class="md:hidden hidden bg-blue-600 border-t border-blue-500">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3 max-h-screen overflow-y-auto">
                <!-- Multi-User Dashboard (Hauptdashboard) -->
                <a href="{{ url_for('multi_user.dashboard') }}" class="block px-3 py-2 rounded-md text-base font-medium hover:bg-blue-700 bg-green-600">
                    <i class="fas fa-tachometer-alt mr-2"></i>Dashboard
                </a>
                
                <!-- Benutzer-Bereich -->
                {% if session.get('user') %}
                    <div class="border-t border-blue-500 pt-2 mt-2">
                        <div class="text-xs font-semibold text-blue-200 px-3 py-1">BENUTZER</div>
                        <div class="px-3 py-2 text-sm text-blue-100">
                            <i class="fas fa-user-circle mr-2"></i>{{ session.user.email }}
                        </div>
                        <a href="{{ url_for('auth_local.profile') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                            <i class="fas fa-user-circle mr-2"></i>Benutzerinfo
                        </a>
                        <a href="{{ url_for('notifications.notification_center') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700 relative">
                            <i class="fas fa-bell mr-2"></i>Benachrichtigungen
                            <span id="mobileNotificationBadge" class="absolute top-2 right-3 bg-red-500 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center hidden">0</span>
                        </a>
                        <a href="{{ url_for('main.help') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                            <i class="fas fa-question-circle mr-2"></i>Hilfe & Anleitungen
                        </a>
                        {% if session.get('role') == 'admin' %}
                        <a href="{{ url_for('admin.dashboard') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700 text-blue-200">
                            <i class="fas fa-tachometer-alt mr-2"></i>Admin-Dashboard
                        </a>
                        <a href="{{ url_for('admin.users') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700 text-blue-200">
                            <i class="fas fa-users mr-2"></i>Benutzer-Verwaltung
                        </a>
                        {% endif %}
                        <a href="{{ url_for('auth_local.logout') }}" class="block px-6 py-2 rounded-md hover:bg-red-700 text-red-200">
                            <i class="fas fa-sign-out-alt mr-2"></i>Abmelden
                        </a>
                    </div>
                {% else %}
                    <a href="{{ url_for('auth_local.login') }}" class="block px-3 py-2 rounded-md text-base font-medium hover:bg-blue-700">
                        <i class="fas fa-sign-in-alt mr-2"></i>Anmelden
                    </a>
                {% endif %}
                
                <div class="space-y-1">
                    <div class="text-xs font-semibold text-blue-200 px-3 py-1">PROJEKTE</div>
                    <a href="{{ url_for('main.projects') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-list mr-2"></i>Alle Projekte
                    </a>
                    <a href="{{ url_for('main.new_project') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-plus mr-2"></i>Neues Projekt
                    </a>
                </div>

                <div class="space-y-1">
                    <div class="text-xs font-semibold text-blue-200 px-3 py-1">KUNDEN</div>
                    <a href="{{ url_for('main.customers') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-list mr-2"></i>Alle Kunden
                    </a>
                    <a href="{{ url_for('main.new_customer') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-user-plus mr-2"></i>Neuer Kunde
                    </a>
                </div>

                <div class="space-y-1">
                    <div class="text-xs font-semibold text-blue-200 px-3 py-1">DATEN</div>
                    <a href="{{ url_for('main.spot_prices') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-bolt mr-2"></i>Spot-Preise
                    </a>
                    <a href="{{ url_for('main.data_import_center') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-database mr-2"></i>Datenimport-Center
                    </a>
                    <a href="{{ url_for('main.preview_data') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-eye mr-2"></i>Datenvorschau
                    </a>
                    <a href="{{ url_for('main.ml_dashboard') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-robot mr-2"></i>ML & KI Dashboard
                    </a>
                    <a href="{{ url_for('main.advanced_ml_dashboard') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-brain mr-2"></i>Advanced ML Dashboard
                    </a>
                    <a href="{{ url_for('main.mcp_dashboard') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-robot mr-2"></i>MCP AI Dashboard
                    </a>
                </div>

                <div class="space-y-1">
                    <div class="text-xs font-semibold text-blue-200 px-3 py-1">WIRTSCHAFTLICHKEIT</div>
                    <a href="{{ url_for('main.investment_costs') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-euro-sign mr-2"></i>Investitionskosten
                    </a>
                    <a href="{{ url_for('main.reference_prices') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-cog mr-2"></i>Referenzpreise
                    </a>
                    <a href="{{ url_for('main.economic_analysis') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-chart-line mr-2"></i>Wirtschaftlichkeitsanalyse
                    </a>
                    <a href="{{ url_for('co2_tracking.co2_dashboard') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-leaf mr-2"></i>CO₂-Tracking & Nachhaltigkeit
                    </a>
                    <a href="/climate/climate-dashboard" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-globe-americas mr-2"></i>Climate Impact Dashboard
                    </a>
                    <a href="/climate/green-finance-dashboard" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-chart-line mr-2"></i>Green Finance Dashboard
                    </a>
                    <a href="/climate/carbon-credits-dashboard" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-certificate mr-2"></i>Carbon Credits Dashboard
                    </a>
                    <a href="/climate/co2-optimization-dashboard" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-leaf mr-2"></i>CO₂-Optimierung Dashboard
                    </a>
                </div>

                <div class="space-y-1">
                    <div class="text-xs font-semibold text-blue-200 px-3 py-1">BESS ANALYSEN</div>
                    <a href="/dispatch" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-rocket mr-2"></i>Dispatch & Redispatch
                    </a>
                    <a href="{{ url_for('main.bess_simulation_enhanced') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-play mr-2"></i>BESS-Simulation
                    </a>
                    <a href="{{ url_for('main.battery_crate_config') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-battery-three-quarters mr-2"></i>C-Rate Config
                    </a>
                    <a href="{{ url_for('main.bess_peak_shaving_analysis') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-chart-bar mr-2"></i>Peak Shaving Analyse
                    </a>
                    <a href="{{ url_for('main.bess_simulation_enhanced') }}" class="block px-6 py-2 rounded-md hover:bg-blue-700">
                        <i class="fas fa-rocket mr-2"></i>Erweiterte Simulation & Dashboard
                    </a>
                </div>
            </div>
        </div>
    </div>
</nav>

<!-- Flash Messages -->
{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-4">
            {% for category, message in messages %}
                <div class="mb-4 p-4 rounded-md {% if category == 'error' %}bg-red-100 border border-red-400 text-red-700{% else %}bg-green-100 border border-green-400 text-green-700{% endif %}">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            {% if category == 'error' %}
                                <i class="fas fa-exclamation-triangle"></i>
                            {% else %}
                                <i class="fas fa-check-circle"></i>
                            {% endif %}
                        </div>
                        <div class="ml-3">
                            <p class="text-sm">{{ message }}</p>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endif %}
{% endwith %}

<!-- Mobile Menu JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('Mobile Menu Script geladen');
    
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    
    console.log('Mobile Menu Button:', mobileMenuButton);
    console.log('Mobile Menu:', mobileMenu);
    
    if (mobileMenuButton && mobileMenu) {
        // Funktion zum Umschalten des Menüs
        function toggleMobileMenu() {
            console.log('Mobile Menu Toggle aufgerufen');
            mobileMenu.classList.toggle('hidden');
            
            // Icon ändern
            const icon = mobileMenuButton.querySelector('i');
            if (mobileMenu.classList.contains('hidden')) {
                icon.className = 'fas fa-bars text-xl';
                console.log('Menü geschlossen');
            } else {
                icon.className = 'fas fa-times text-xl';
                console.log('Menü geöffnet');
            }
        }
        
        // Event-Handler für Maus und Touch
        function handleMenuToggle(e) {
            e.preventDefault();
            e.stopPropagation();
            toggleMobileMenu();
        }
        
        // Maus-Events (für verkleinerten Browser)
        mobileMenuButton.addEventListener('click', handleMenuToggle);
        mobileMenuButton.addEventListener('mousedown', handleMenuToggle);
        
        // Touch-Events (für mobile Geräte)
        mobileMenuButton.addEventListener('touchstart', function(e) {
            e.preventDefault();
            e.stopPropagation();
            toggleMobileMenu();
        });
        
        mobileMenuButton.addEventListener('touchend', function(e) {
            e.preventDefault();
            e.stopPropagation();
        });
        
        // Mobile Menu schließen beim Klicken außerhalb
        document.addEventListener('click', function(e) {
            if (!e.target.closest('#mobile-menu') && !e.target.closest('#mobile-menu-button')) {
                mobileMenu.classList.add('hidden');
                const icon = mobileMenuButton.querySelector('i');
                icon.className = 'fas fa-bars text-xl';
            }
        });
        
        // Mobile Menu schließen beim Scrollen
        window.addEventListener('scroll', function() {
            mobileMenu.classList.add('hidden');
            const icon = mobileMenuButton.querySelector('i');
            icon.className = 'fas fa-bars text-xl';
        });
        
        console.log('Mobile Menu Event Listener registriert');
    } else {
        console.error('Mobile Menu Elemente nicht gefunden!');
    }
});

// Dropdown-Menüs für Desktop und Mobile
document.addEventListener('DOMContentLoaded', function() {
    const dropdownGroups = document.querySelectorAll('.group');
    dropdownGroups.forEach(group => {
        const button = group.querySelector('button');
        const dropdown = group.querySelector('div[class*="absolute"]');
        
        if (button && dropdown) {
            // Hover-Effekt für Desktop
            group.addEventListener('mouseenter', function() {
                dropdown.classList.remove('opacity-0', 'invisible');
                dropdown.classList.add('opacity-100', 'visible');
            });
            
            group.addEventListener('mouseleave', function() {
                dropdown.classList.add('opacity-0', 'invisible');
                dropdown.classList.remove('opacity-100', 'visible');
            });
            
            // Touch-Events für Mobile (Safari, etc.)
            button.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                
                // Alle anderen Dropdowns schließen
                dropdownGroups.forEach(otherGroup => {
                    if (otherGroup !== group) {
                        const otherDropdown = otherGroup.querySelector('div[class*="absolute"]');
                        if (otherDropdown) {
                            otherDropdown.classList.add('opacity-0', 'invisible');
                            otherDropdown.classList.remove('opacity-100', 'visible');
                        }
                    }
                });
                
                // Aktuelles Dropdown umschalten
                if (dropdown.classList.contains('opacity-0')) {
                    dropdown.classList.remove('opacity-0', 'invisible');
                    dropdown.classList.add('opacity-100', 'visible');
                } else {
                    dropdown.classList.add('opacity-0', 'invisible');
                    dropdown.classList.remove('opacity-100', 'visible');
                }
            });
        }
    });
    
    // Dropdowns schließen beim Klicken außerhalb
    document.addEventListener('click', function(e) {
        if (!e.target.closest('.group')) {
            dropdownGroups.forEach(group => {
                const dropdown = group.querySelector('div[class*="absolute"]');
                if (dropdown) {
                    dropdown.classList.add('opacity-0', 'invisible');
                    dropdown.classList.remove('opacity-100', 'visible');
                }
            });
        }
    });
});
</script> 