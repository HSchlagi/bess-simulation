<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ML & KI Dashboard - BESS Simulation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/date-fns@2.29.3/index.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<style>
        .card-hover {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
</style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    {% include 'header_simple.html' %}

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Page Title -->
    <div class="mb-8">
            <h1 class="text-3xl font-bold text-gray-800 flex items-center">
            ü§ñ ML & KI Dashboard
        </h1>
            <p class="text-gray-600 mt-2">Intelligente Optimierung und Prognosen f√ºr Ihre BESS-Systeme</p>
    </div>

        <!-- Projekt ausw√§hlen - Ganz oben -->
        <div class="bg-white rounded-xl shadow-lg p-6 card-hover mb-8">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl font-bold text-gray-800">üìÅ Projekt ausw√§hlen</h2>
            </div>
            <div class="flex space-x-4">
                <select id="project-select" class="flex-1 border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="bess-hinterstoder">BESS Hinterstoder</option>
                    <option value="bess-salzburg">BESS Salzburg</option>
                    <option value="bess-wien">BESS Wien</option>
            </select>
                <button onclick="loadProjectData()" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-6 rounded-lg transition">
                    üìä Daten laden
            </button>
        </div>
    </div>

        <!-- Dashboard Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        
        <!-- Preis-Prognosen -->
            <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
            <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-bold text-gray-800">üìà Preis-Prognosen</h2>
                    <button onclick="startPriceForecast()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm transition">
                    Prognose starten
                </button>
            </div>
                <div class="space-y-4">
                    <div class="h-64">
                        <canvas id="priceForecastChart"></canvas>
                </div>
                <div class="grid grid-cols-2 gap-4 text-sm">
                        <div class="bg-gray-50 p-3 rounded-lg">
                        <span class="text-gray-600">Durchschnittspreis:</span>
                            <span class="font-bold text-green-600" id="avg-price">52.05 ‚Ç¨/MWh</span>
                    </div>
                        <div class="bg-gray-50 p-3 rounded-lg">
                        <span class="text-gray-600">Maximaler Preis:</span>
                            <span class="font-bold text-red-600" id="max-price">72.58 ‚Ç¨/MWh</span>
                        </div>
                    </div>
            </div>
        </div>

        <!-- BESS-Optimierung -->
            <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
            <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-bold text-gray-800">‚öôÔ∏è BESS-Optimierung</h2>
                    <button onclick="optimizeBESS()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm transition">
                    Optimieren
                </button>
            </div>
                <div class="space-y-4">
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <span class="text-gray-600">Lade-Wirkungsgrad:</span>
                            <span class="font-bold text-blue-600" id="charge-efficiency">95.0%</span>
                        </div>
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <span class="text-gray-600">Max. SoC:</span>
                            <span class="font-bold text-blue-600" id="max-soc">95.0%</span>
                        </div>
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <span class="text-gray-600">Entlade-Wirkungsgrad:</span>
                            <span class="font-bold text-blue-600" id="discharge-efficiency">95.0%</span>
                        </div>
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <span class="text-gray-600">Min. SoC:</span>
                            <span class="font-bold text-blue-600" id="min-soc">15.0%</span>
                        </div>
                    </div>
                    <div class="border-t pt-4">
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="bg-green-50 p-3 rounded-lg">
                                <span class="text-gray-600">Effizienz-Steigerung:</span>
                                <span class="font-bold text-green-600" id="efficiency-gain">8.5%</span>
                            </div>
                            <div class="bg-green-50 p-3 rounded-lg">
                                <span class="text-gray-600">Gesch√§tzte j√§hrliche Einsparungen:</span>
                                <span class="font-bold text-green-600" id="annual-savings">20000.00 ‚Ç¨</span>
                            </div>
                        </div>
                    </div>
            </div>
        </div>

        <!-- Anomalie-Erkennung -->
            <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
            <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-bold text-gray-800">üîç Anomalie-Erkennung</h2>
                    <button onclick="analyzeAnomalies()" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg text-sm transition">
                    Analysieren
                </button>
            </div>
                <div class="space-y-4">
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-gray-600">Anomalie-Rate:</span>
                            <span class="font-bold text-orange-600" id="anomaly-rate">25.00 %</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-orange-500 h-2 rounded-full" style="width: 25%"></div>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <h4 class="font-semibold text-gray-700">Erkannte Anomalien:</h4>
                        <div class="space-y-2 text-sm">
                            <div class="bg-red-50 p-2 rounded border-l-4 border-red-500">
                                <span class="font-medium">7.9.2025, 21:20:27</span> - <span class="text-red-600">101.1 kW</span>
                            </div>
                            <div class="bg-red-50 p-2 rounded border-l-4 border-red-500">
                                <span class="font-medium">4.9.2025, 11:20:27</span> - <span class="text-red-600">123.8 kW</span>
                </div>
                </div>
            </div>
            </div>
        </div>

        <!-- Predictive Maintenance -->
            <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
            <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-bold text-gray-800">üîß Predictive Maintenance</h2>
                    <button onclick="analyzeMaintenance()" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-sm transition">
                    Analysieren
                </button>
            </div>
                <div class="space-y-4">
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <span class="text-gray-600">Zyklen abgeschlossen:</span>
                            <span class="font-bold text-blue-600" id="cycles-completed">1587</span>
                        </div>
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <span class="text-gray-600">Durchschnittstemperatur:</span>
                            <span class="font-bold text-blue-600" id="avg-temperature">22.2¬∞C</span>
                        </div>
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <span class="text-gray-600">Alter (Tage):</span>
                            <span class="font-bold text-blue-600" id="age-days">794</span>
                        </div>
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <span class="text-gray-600">Durchschnittliche DoD:</span>
                            <span class="font-bold text-blue-600" id="avg-dod">93.0%</span>
                        </div>
                    </div>
                    <div class="border-t pt-4">
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="bg-yellow-50 p-3 rounded-lg">
                                <span class="text-gray-600">Vorhergesagte Degradation:</span>
                                <span class="font-bold text-yellow-600" id="predicted-degradation">1.7%</span>
                            </div>
                            <div class="bg-green-50 p-3 rounded-lg">
                                <span class="text-gray-600">Verbleibende Kapazit√§t:</span>
                                <span class="font-bold text-green-600" id="remaining-capacity">97.0%</span>
                            </div>
                        </div>
                        <div class="bg-blue-50 p-3 rounded-lg mt-4">
                            <span class="text-gray-600">Wartungsempfehlung:</span>
                            <span class="font-bold text-blue-600" id="maintenance-recommendation">Batterie-Gesundheit gut - N√§chste Routine-Inspektion in 3 Monaten</span>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- ML-Modell-Status Section -->
        <div class="mt-12">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                üìä ML-Modell-Status
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="bg-white rounded-lg shadow-md p-6 text-center">
                    <div class="text-3xl mb-3">üìà</div>
                    <h3 class="font-semibold text-gray-800 mb-2">Preis-Prognose</h3>
                    <span class="inline-block bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm">Trainiert</span>
    </div>
                <div class="bg-white rounded-lg shadow-md p-6 text-center">
                    <div class="text-3xl mb-3">‚öôÔ∏è</div>
                    <h3 class="font-semibold text-gray-800 mb-2">BESS-Optimierung</h3>
                    <span class="inline-block bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">Verf√ºgbar</span>
            </div>
                <div class="bg-white rounded-lg shadow-md p-6 text-center">
                    <div class="text-3xl mb-3">üîç</div>
                    <h3 class="font-semibold text-gray-800 mb-2">Anomalie-Erkennung</h3>
                    <span class="inline-block bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm">Trainiert</span>
            </div>
                <div class="bg-white rounded-lg shadow-md p-6 text-center">
                    <div class="text-3xl mb-3">üîß</div>
                    <h3 class="font-semibold text-gray-800 mb-2">Predictive Maintenance</h3>
                    <span class="inline-block bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm">Trainiert</span>
            </div>
            </div>
        </div>
    </main>

<script>
        // Chart.js Konfiguration
        let priceForecastChart;

        // Demo-Daten f√ºr Preis-Prognosen (n√§chster Tag)
        function generatePriceForecastLabels() {
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            const labels = [];
            
            // 24 Stunden Prognose f√ºr morgen (alle 2 Stunden)
            for (let hour = 0; hour < 24; hour += 2) {
                const time = new Date(tomorrow);
                time.setHours(hour, 20, 0, 0);
                labels.push(time.toLocaleTimeString('de-DE', { 
                    hour: '2-digit', 
                    minute: '2-digit',
                    day: '2-digit',
                    month: '2-digit'
                }));
            }
            return labels;
        }

        const demoPriceData = {
            labels: generatePriceForecastLabels(),
            datasets: [{
                label: 'Prognostizierter Preis (‚Ç¨/MWh) - Morgen',
                data: [45.2, 52.8, 68.4, 72.6, 58.9, 42.1, 38.7, 41.3, 48.9, 55.2, 61.8, 58.4],
                borderColor: 'rgb(59, 130, 246)',
                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                tension: 0.4,
                fill: true
            }]
        };

        // Chart initialisieren
        function initCharts() {
            const ctx = document.getElementById('priceForecastChart').getContext('2d');
        priceForecastChart = new Chart(ctx, {
            type: 'line',
                data: demoPriceData,
                    options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                            beginAtZero: false,
                        title: {
                            display: true,
                            text: 'Preis (‚Ç¨/MWh)'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Zeit'
                        }
                    }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        }
                    }
                }
            });
        }

        // Funktionen
        function loadProjectData() {
            const project = document.getElementById('project-select').value;
            console.log('Lade Daten f√ºr Projekt:', project);
            
            // Simuliere Ladevorgang
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = '‚è≥ Lade...';
            button.disabled = true;
            
            setTimeout(() => {
                button.textContent = originalText;
                button.disabled = false;
                alert(`Daten f√ºr ${project} erfolgreich geladen!`);
            }, 2000);
        }

        function startPriceForecast() {
            console.log('Starte Preis-Prognose...');
            
            // Simuliere Prognose-Berechnung
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = '‚è≥ Berechne...';
            button.disabled = true;
            
            setTimeout(() => {
                button.textContent = originalText;
                button.disabled = false;
                
                // Aktualisiere Chart mit neuen Daten
                const newData = demoPriceData.datasets[0].data.map(val => val + (Math.random() - 0.5) * 10);
                priceForecastChart.data.datasets[0].data = newData;
                priceForecastChart.update();
                
                // Aktualisiere Statistiken
                const avgPrice = (newData.reduce((a, b) => a + b, 0) / newData.length).toFixed(2);
                const maxPrice = Math.max(...newData).toFixed(2);
                
                document.getElementById('avg-price').textContent = `${avgPrice} ‚Ç¨/MWh`;
                document.getElementById('max-price').textContent = `${maxPrice} ‚Ç¨/MWh`;
                
                alert('Preis-Prognose erfolgreich erstellt!');
            }, 3000);
        }

        function optimizeBESS() {
            console.log('Starte BESS-Optimierung...');
            
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = '‚è≥ Optimiere...';
            button.disabled = true;
            
            setTimeout(() => {
                button.textContent = originalText;
                button.disabled = false;
                
                // Simuliere Optimierungsergebnisse
                const efficiencyGain = (Math.random() * 5 + 5).toFixed(1);
                const annualSavings = (Math.random() * 10000 + 15000).toFixed(2);
                
                document.getElementById('efficiency-gain').textContent = `${efficiencyGain}%`;
                document.getElementById('annual-savings').textContent = `${annualSavings} ‚Ç¨`;
                
                alert('BESS-Optimierung erfolgreich abgeschlossen!');
            }, 2500);
        }

        function analyzeAnomalies() {
            console.log('Starte Anomalie-Analyse...');
            
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = '‚è≥ Analysiere...';
            button.disabled = true;
            
            setTimeout(() => {
                button.textContent = originalText;
                button.disabled = false;
                
                // Simuliere Anomalie-Ergebnisse
                const anomalyRate = (Math.random() * 30 + 10).toFixed(2);
                document.getElementById('anomaly-rate').textContent = `${anomalyRate} %`;
                
                // Aktualisiere Progress Bar
                const progressBar = document.querySelector('.bg-orange-500');
                progressBar.style.width = `${anomalyRate}%`;
                
                alert('Anomalie-Analyse erfolgreich abgeschlossen!');
            }, 2000);
        }

        function analyzeMaintenance() {
            console.log('Starte Predictive Maintenance...');
            
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = '‚è≥ Analysiere...';
            button.disabled = true;
            
            setTimeout(() => {
                button.textContent = originalText;
                button.disabled = false;
                
                // Simuliere Maintenance-Ergebnisse
                const degradation = (Math.random() * 2 + 1).toFixed(1);
                const capacity = (100 - degradation).toFixed(1);
                
                document.getElementById('predicted-degradation').textContent = `${degradation}%`;
                document.getElementById('remaining-capacity').textContent = `${capacity}%`;
                
                alert('Predictive Maintenance-Analyse erfolgreich abgeschlossen!');
            }, 2500);
        }

        // Initialisierung
        document.addEventListener('DOMContentLoaded', function() {
            initCharts();
        });
</script>

    <!-- Footer -->
    {% include 'footer.html' %}
</body>
</html>