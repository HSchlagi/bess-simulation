{% extends "base.html" %}

{% block title %}Projekt bearbeiten{% endblock %}

{% block head %}
<script src="{{ url_for('static', filename='js/auto-save.js') }}"></script>
<script src="{{ url_for('static', filename='js/form-validation.js') }}"></script>
{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <div class="bg-white rounded-xl shadow-md border border-gray-100 p-8">
        <h1 class="text-3xl font-bold text-gray-900 mb-6">Projekt bearbeiten</h1>
        
        <form id="editProjectForm" class="space-y-6">
            <!-- Grundinformationen -->
            <div class="bg-gray-50 p-6 rounded-lg">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Grundinformationen</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Projektname *</label>
                        <input type="text" id="projectName" name="name" required 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Standort</label>
                        <input type="text" id="projectLocation" name="location" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Kunde</label>
                        <select id="customerSelect" name="customer_id" 
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">Kunde auswählen...</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Projektdatum</label>
                        <input type="date" id="projectDate" name="date" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
            </div>

            <!-- Technische Spezifikationen -->
            <div class="bg-blue-50 p-6 rounded-lg">
                <h3 class="text-lg font-semibold text-blue-900 mb-4">Technische Spezifikationen</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">BESS Größe (kWh)</label>
                        <input type="number" id="bessSize" name="bess_size" step="0.1" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">BESS Leistung (kW)</label>
                        <input type="number" id="bessPower" name="bess_power" step="0.1" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">PV Leistung (kW)</label>
                        <input type="number" id="pvPower" name="pv_power" step="0.1" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Wärmepumpe (kW)</label>
                        <input type="number" id="hpPower" name="hp_power" step="0.1" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Windkraft (kW)</label>
                        <input type="number" id="windPower" name="wind_power" step="0.1" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Wasserkraft (kW)</label>
                        <input type="number" id="hydroPower" name="hydro_power" step="0.1" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                            <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Sonstiges (kW)</label>
            <input type="number" id="otherPower" name="other_power" step="0.1" 
                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
        </div>
    </div>

    <!-- Betriebsparameter -->
    <div class="mt-6">
        <h3 class="text-lg font-medium text-gray-900 mb-4 flex items-center">
            <i class="fas fa-cogs mr-2 text-blue-600"></i>
            Betriebsparameter
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Aktuelle Stromkosten (Ct/kWh)</label>
                <input type="number" id="currentElectricityCost" name="current_electricity_cost" step="0.1" min="0"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="12.5">
                <p class="text-xs text-gray-500 mt-1">Aktuelle Stromkosten für die Wirtschaftlichkeitsberechnung</p>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Tägliche BESS-Zyklen</label>
                <input type="number" id="dailyCycles" name="daily_cycles" step="0.1" min="0.1" max="3.0"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="1.2">
                <p class="text-xs text-gray-500 mt-1">Anzahl der täglichen Lade-/Entladezyklen (0.1 - 3.0)</p>
            </div>
        </div>
    </div>
            </div>

            <!-- Investitionskosten -->
            <div class="bg-green-50 p-6 rounded-lg">
                <h3 class="text-lg font-semibold text-green-900 mb-4">
                    <i class="fas fa-euro-sign mr-2"></i>Investitionskosten (€)
                </h3>
                <p class="text-sm text-green-700 mb-4">Geben Sie die Investitionskosten für die Wirtschaftlichkeitsberechnung ein</p>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">BESS Kosten (€)</label>
                        <input type="number" id="bessCost" name="bess_cost" step="0.01" min="0"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                               placeholder="0.00">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">PV Kosten (€)</label>
                        <input type="number" id="pvCost" name="pv_cost" step="0.01" min="0"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                               placeholder="0.00">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Wärmepumpe Kosten (€)</label>
                        <input type="number" id="hpCost" name="hp_cost" step="0.01" min="0"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                               placeholder="0.00">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Windkraft Kosten (€)</label>
                        <input type="number" id="windCost" name="wind_cost" step="0.01" min="0"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                               placeholder="0.00">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Wasserkraft Kosten (€)</label>
                        <input type="number" id="hydroCost" name="hydro_cost" step="0.01" min="0"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                               placeholder="0.00">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Sonstiges Kosten (€)</label>
                        <input type="number" id="otherCost" name="other_cost" step="0.01" min="0"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                               placeholder="0.00">
                    </div>
                </div>
                
                <!-- Gesamtkosten Anzeige -->
                <div class="mt-4 p-4 bg-white rounded-lg border border-green-200">
                    <div class="flex justify-between items-center">
                        <span class="text-lg font-semibold text-green-900">Gesamtinvestition:</span>
                        <span class="text-2xl font-bold text-green-600" id="totalCost">0,00 €</span>
                    </div>
                </div>
            </div>

            <!-- Aktionen -->
            <div class="flex justify-between items-center pt-6 border-t border-gray-200">
                <a href="{{ url_for('main.projects') }}" 
                   class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-md">
                    <i class="fas fa-arrow-left mr-2"></i>Zurück
                </a>
                <div class="flex space-x-2">
                    <button type="button" onclick="deleteProject()" 
                            class="bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-md">
                        <i class="fas fa-trash mr-2"></i>Löschen
                    </button>
                    <button type="submit" 
                            class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-md">
                        <i class="fas fa-save mr-2"></i>Änderungen speichern
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>

<script>
let currentProjectId = null;



document.addEventListener('DOMContentLoaded', function() {
    console.log('🚀 DOM geladen - Starte Projekt-Laden...');
    
    // Projekt-ID aus URL extrahieren
    const urlParams = new URLSearchParams(window.location.search);
    currentProjectId = urlParams.get('id');
    
    // Debug: URL-Parameter anzeigen
    console.log('🔍 URL-Parameter:', Object.fromEntries(urlParams.entries()));
    console.log('🔍 Projekt-ID aus URL:', currentProjectId);
    
    // SOFORTIGE LÖSUNG: Projekt laden
    if (currentProjectId) {
        console.log('📥 Lade Projekt mit ID:', currentProjectId);
        loadProjectData(currentProjectId);
    } else {
        console.log('❌ Keine Projekt-ID gefunden');
    }
    if (!currentProjectId || currentProjectId === 'null' || currentProjectId === 'undefined' || currentProjectId === '') {
        console.log('❌ Ungültige Projekt-ID - leite zur Projekt-Übersicht weiter');
        window.location.replace('/projects');
        return;
    }
    
    // EINFACHE LÖSUNG: Prüfe URL-Parameter für daily_cycles
    const urlDailyCycles = urlParams.get('daily_cycles');
    
    if (urlDailyCycles && urlDailyCycles !== '' && urlDailyCycles !== 'null') {
        console.log('🔍 URL-Parameter daily_cycles gefunden:', urlDailyCycles);
        // EINFACHE LÖSUNG: Setze den Wert direkt im Formular
        const dailyCyclesInput = document.getElementById('dailyCycles');
        if (dailyCyclesInput) {
            const urlValue = parseFloat(urlDailyCycles);
            if (!isNaN(urlValue) && urlValue > 0) {
                console.log('✅ Setze daily_cycles direkt auf URL-Wert:', urlValue);
                dailyCyclesInput.value = urlValue;
            }
        }
    }
    
    // Projekt laden (nur wenn wir hier ankommen, ist die ID gültig)
    loadProjectData(currentProjectId);
    loadCustomers();
    
    // Auto-Save System initialisieren (vereinfacht)
    console.log('🚀 Initialisiere Auto-Save System...');
    
    // Prüfe ob Auto-Save verfügbar ist
    if (typeof initAutoSave === 'function') {
        setTimeout(() => {
            const autoSave = initAutoSave('editProjectForm', {
                autoSaveInterval: 30000, // 30 Sekunden
                maxUndoSteps: 10
            });
            
            if (autoSave) {
                console.log('✅ Auto-Save System erfolgreich initialisiert');
            } else {
                console.log('❌ Auto-Save System konnte nicht initialisiert werden');
            }
        }, 1000);
    } else {
        console.log('⚠️ Auto-Save System nicht verfügbar - initAutoSave Funktion nicht gefunden');
    }
    
    // Erweiterte Formular-Validierung initialisieren
    const validator = initFormValidator('editProjectForm', {
        showProgress: true,
        realTimeValidation: true,
        validateOnBlur: true
    });
    
    // Formular-Handler
    document.getElementById('editProjectForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Validierung vor dem Submit
        if (validator.validateForSubmit()) {
            updateProject();
        }
    });
    
    // Event Listeners für die Kostenfelder
    const costFields = ['bessCost', 'pvCost', 'hpCost', 'windCost', 'hydroCost', 'otherCost'];
    costFields.forEach(fieldId => {
        const field = document.getElementById(fieldId);
        if (field) {
            field.addEventListener('input', calculateTotalCost);
        }
    });
    
    // Keyboard-Shortcuts Info anzeigen
    showKeyboardShortcuts();
});

function loadProjectData(projectId) {
    console.log(`🚀 Lade Projektdaten für ID ${projectId}`);
    
    // Prüfe ob projectId gültig ist
    if (!projectId || projectId === 'null' || projectId === 'undefined') {
        console.error('❌ Ungültige Projekt-ID:', projectId);
        alert('Ungültige Projekt-ID. Sie werden zur Projekt-Übersicht weitergeleitet.');
        window.location.href = '/projects';
        return;
    }
    
    fetch(`/api/projects/${projectId}`)
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            return response.json();
        })
        .then(project => {
            console.log('✅ Projektdaten geladen:', project);
            
            // EINFACHE UND SICHERE LÖSUNG: Formular direkt füllen
            fillFormWithProjectData(project);
        })
        .catch(error => {
            console.error('❌ Fehler beim Laden der Projektdaten:', error);
            alert('Fehler beim Laden der Projektdaten. Bitte versuchen Sie es erneut.');
        });
}

function fillFormWithProjectData(project) {
    console.log('🔧 Fülle Formular mit Projektdaten...');
    
    // Alle Formularfelder direkt setzen
    const fields = {
        'projectName': project.name,
        'projectLocation': project.location,
        'customerSelect': project.customer_id,
        'projectDate': project.date,
        'bessSize': project.bess_size,
        'bessPower': project.bess_power,
        'pvPower': project.pv_power,
        'hpPower': project.hp_power,
        'windPower': project.wind_power,
        'hydroPower': project.hydro_power,
        'otherPower': project.other_power,
        'currentElectricityCost': project.current_electricity_cost || 12.5,
        'dailyCycles': project.daily_cycles || 1.2,
        'bessCost': project.bess_cost,
        'pvCost': project.pv_cost,
        'hpCost': project.hp_cost,
        'windCost': project.wind_cost,
        'hydroCost': project.hydro_cost,
        'otherCost': project.other_cost
    };
    
    // Jedes Feld setzen
    Object.keys(fields).forEach(fieldId => {
        const element = document.getElementById(fieldId);
        if (element) {
            // Spezielle Behandlung für daily_cycles
            if (fieldId === 'dailyCycles') {
                const dailyCyclesValue = fields[fieldId];
                console.log(`🔍 dailyCycles Wert aus API:`, dailyCyclesValue);
                console.log(`🔍 dailyCycles Typ:`, typeof dailyCyclesValue);
                
                if (dailyCyclesValue !== null && dailyCyclesValue !== undefined && dailyCyclesValue !== '') {
                    // EINFACHE LÖSUNG: Stelle sicher, dass der Wert als Punkt-Dezimaltrennzeichen gesetzt wird
                    const numericValue = parseFloat(dailyCyclesValue);
                    if (!isNaN(numericValue)) {
                        element.value = numericValue.toString().replace(',', '.'); // Komma durch Punkt ersetzen
                        console.log(`✅ dailyCycles explizit gesetzt auf:`, element.value);
                    } else {
                        element.value = 1.2; // Standardwert
                        console.log(`⚠️ dailyCycles Standardwert gesetzt (ungültiger Wert):`, element.value);
                    }
                } else {
                    element.value = 1.2; // Standardwert
                    console.log(`⚠️ dailyCycles Standardwert gesetzt (leerer Wert):`, element.value);
                }
            } else {
                element.value = fields[fieldId] || '';
            }
            console.log(`✅ ${fieldId} gesetzt:`, element.value);
        } else {
            console.log(`❌ Element ${fieldId} nicht gefunden`);
        }
    });
    
    console.log('✅ Formular erfolgreich gefüllt');
    
    // Gesamtkosten berechnen
    calculateTotalCost();
}

function loadCustomers() {
    fetch('/api/customers')
        .then(response => response.json())
        .then(customers => {
            const select = document.getElementById('customerSelect');
            customers.forEach(customer => {
                const option = document.createElement('option');
                option.value = customer.id;
                option.textContent = `${customer.name}${customer.company ? ' - ' + customer.company : ''}`;
                select.appendChild(option);
            });
        })
        .catch(error => console.error('Fehler beim Laden der Kunden:', error));
}

function updateProject() {
    const formData = new FormData(document.getElementById('editProjectForm'));
    
    // Validierung
    const name = formData.get('name');
    if (!name || name.trim() === '') {
        alert('Projektname ist erforderlich!');
        return;
    }
    
    // Debug-Ausgabe
    console.log('=== DEBUG: Formular-Daten ===');
    for (let [key, value] of formData.entries()) {
        console.log(`${key}: ${value}`);
    }
    
    const projectData = {
        name: name.trim(),
        location: formData.get('location') || '',
        customer_id: (() => {
            const customerId = formData.get('customer_id');
            console.log('DEBUG: customer_id raw:', customerId);
            if (customerId && customerId !== '' && customerId !== 'null') {
                return parseInt(customerId);
            }
            return null;
        })(),
        date: formData.get('date') || null,
        bess_size: formData.get('bess_size') ? parseFloat(formData.get('bess_size')) : null,
        bess_power: formData.get('bess_power') ? parseFloat(formData.get('bess_power')) : null,
        pv_power: formData.get('pv_power') ? parseFloat(formData.get('pv_power')) : null,
        hp_power: formData.get('hp_power') ? parseFloat(formData.get('hp_power')) : null,
        wind_power: formData.get('wind_power') ? parseFloat(formData.get('wind_power')) : null,
        hydro_power: formData.get('hydro_power') ? parseFloat(formData.get('hydro_power')) : null,
        other_power: formData.get('other_power') ? parseFloat(formData.get('other_power')) : null,
                        daily_cycles: (() => {
                    const dailyCycles = formData.get('daily_cycles');
                    console.log('DEBUG: daily_cycles raw:', dailyCycles);
                    console.log('DEBUG: daily_cycles type:', typeof dailyCycles);
                    
                    // EINFACHE LÖSUNG: Stelle sicher, dass der Wert korrekt verarbeitet wird
                    if (dailyCycles && dailyCycles !== '' && dailyCycles !== 'null' && dailyCycles !== 'undefined') {
                        // EINFACHE LÖSUNG: Komma durch Punkt ersetzen für korrekte Parsing
                        const normalizedValue = dailyCycles.toString().replace(',', '.');
                        const parsed = parseFloat(normalizedValue);
                        console.log('DEBUG: daily_cycles normalized:', normalizedValue);
                        console.log('DEBUG: daily_cycles parsed:', parsed);
                        console.log('DEBUG: daily_cycles parsed type:', typeof parsed);
                        
                        // EINFACHE LÖSUNG: Stelle sicher, dass der Wert gültig ist
                        if (!isNaN(parsed) && parsed > 0) {
                            console.log('DEBUG: daily_cycles final:', parsed);
                            return parsed;
                        } else {
                            console.log('DEBUG: daily_cycles invalid parsed value, using default');
                        }
                    }
                    console.log('DEBUG: daily_cycles using default: 1.2');
                    return 1.2;
                })(),
        current_electricity_cost: formData.get('current_electricity_cost') ? parseFloat(formData.get('current_electricity_cost')) : 12.5,
        bess_cost: formData.get('bess_cost') ? parseFloat(formData.get('bess_cost')) : null,
        pv_cost: formData.get('pv_cost') ? parseFloat(formData.get('pv_cost')) : null,
        hp_cost: formData.get('hp_cost') ? parseFloat(formData.get('hp_cost')) : null,
        wind_cost: formData.get('wind_cost') ? parseFloat(formData.get('wind_cost')) : null,
        hydro_cost: formData.get('hydro_cost') ? parseFloat(formData.get('hydro_cost')) : null,
        other_cost: formData.get('other_cost') ? parseFloat(formData.get('other_cost')) : null
    };
    
    console.log('=== DEBUG: Gesendete Daten ===');
    console.log(JSON.stringify(projectData, null, 2));

    // Loading-Zustand anzeigen
    const submitButton = document.querySelector('button[type="submit"]');
    const originalText = submitButton.innerHTML;
    submitButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Speichern...';
    submitButton.disabled = true;

    fetch(`/api/projects/${currentProjectId}`, {
        method: 'PUT',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(projectData)
    })
    .then(response => {
        if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
        }
        return response.json();
    })
    .then(data => {
        if (data.success) {
            alert('Projekt erfolgreich aktualisiert!');
            // EINFACHE LÖSUNG: Lade das Formular neu mit den aktualisierten Daten
            console.log('✅ Projekt erfolgreich aktualisiert - lade Formular neu');
            loadProjectData(currentProjectId);
        } else {
            throw new Error(data.error || 'Unbekannter Fehler');
        }
    })
    .catch(error => {
        console.error('Fehler:', error);
        alert('Fehler beim Aktualisieren des Projekts: ' + error.message);
    })
    .finally(() => {
        // Loading-Zustand zurücksetzen
        submitButton.innerHTML = originalText;
        submitButton.disabled = false;
    });
}

function deleteProject() {
    if (confirm('Sind Sie sicher, dass Sie dieses Projekt löschen möchten? Diese Aktion kann nicht rückgängig gemacht werden.')) {
        fetch(`/api/projects/${currentProjectId}`, {
            method: 'DELETE'
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert('Projekt erfolgreich gelöscht!');
                window.location.href = '/projects';
            } else {
                alert('Fehler beim Löschen des Projekts: ' + data.error);
            }
        })
        .catch(error => {
            console.error('Fehler:', error);
            alert('Fehler beim Löschen des Projekts');
        });
    }
}

function calculateTotalCost() {
    const bessCost = parseFloat(document.getElementById('bessCost').value) || 0;
    const pvCost = parseFloat(document.getElementById('pvCost').value) || 0;
    const hpCost = parseFloat(document.getElementById('hpCost').value) || 0;
    const windCost = parseFloat(document.getElementById('windCost').value) || 0;
    const hydroCost = parseFloat(document.getElementById('hydroCost').value) || 0;
    const otherCost = parseFloat(document.getElementById('otherCost').value) || 0;

    const total = bessCost + pvCost + hpCost + windCost + hydroCost + otherCost;
    document.getElementById('totalCost').textContent = total.toFixed(2) + ' €';
}

// Event Listeners für die Kostenfelder
document.getElementById('bessCost').addEventListener('input', calculateTotalCost);
document.getElementById('pvCost').addEventListener('input', calculateTotalCost);
document.getElementById('hpCost').addEventListener('input', calculateTotalCost);
document.getElementById('windCost').addEventListener('input', calculateTotalCost);
document.getElementById('hydroCost').addEventListener('input', calculateTotalCost);
document.getElementById('otherCost').addEventListener('input', calculateTotalCost);

function showKeyboardShortcuts() {
    const shortcutsDiv = document.createElement('div');
    shortcutsDiv.className = 'fixed bottom-4 left-4 bg-white border border-gray-300 rounded-lg shadow-lg p-3 text-xs z-40';
    shortcutsDiv.innerHTML = `
        <div class="font-medium text-gray-900 mb-2">Keyboard-Shortcuts:</div>
        <div class="space-y-1 text-gray-600">
            <div>Ctrl+S: Speichern</div>
            <div>Ctrl+Z: Rückgängig</div>
            <div>Ctrl+Y: Wiederholen</div>
        </div>
    `;
    document.body.appendChild(shortcutsDiv);
    
    // Nach 10 Sekunden ausblenden
    setTimeout(() => {
        shortcutsDiv.style.opacity = '0.5';
    }, 5000);
}
</script>
{% endblock %} 