<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Content Security Policy - Chart.js und Font Awesome erlauben -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://use.fontawesome.com; script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; font-src 'self' https://cdnjs.cloudflare.com https://use.fontawesome.com;">
    
    <title>{% block title %}BESS Simulation{% endblock %}</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='favicon-32x32.png') }}">
    <link rel="icon" type="image/png" sizes="48x48" href="{{ url_for('static', filename='favicon-48x48.png') }}">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Mobile Optimierungen -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="BESS Simulation">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#3B82F6">
    <meta name="msapplication-TileColor" content="#3B82F6">
    
    <!-- Touch Icons -->
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='apple-touch-icon.png') }}">
    <link rel="apple-touch-icon" sizes="152x152" href="{{ url_for('static', filename='apple-touch-icon-152x152.png') }}">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='apple-touch-icon-180x180.png') }}">
    <link rel="apple-touch-icon" sizes="167x167" href="{{ url_for('static', filename='apple-touch-icon-167x167.png') }}">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
    
    <!-- PWA Meta Tags -->
    <meta name="application-name" content="BESS Simulation">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="BESS PWA">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="msapplication-config" content="/static/browserconfig.xml">
    <meta name="msapplication-TileColor" content="#3b82f6">
    <meta name="msapplication-tap-highlight" content="no">
    
    <!-- PWA Icons -->
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='icons/icon-192x192.png') }}">
    <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='icons/icon-32x32.png') }}">
    <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='icons/icon-16x16.png') }}">
    <link rel="mask-icon" href="{{ url_for('static', filename='icons/safari-pinned-tab.svg') }}" color="#3b82f6">
    
    <!-- PWA JavaScript -->
    <script src="{{ url_for('static', filename='js/pwa.js') }}" defer></script>
    
    <!-- Benachrichtigungs-System -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.min.js"></script>
    <script src="{{ url_for('static', filename='js/notification-system.js') }}"></script>
    
    <!-- Font Awesome - Intelligente Fallback-Lösung -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- XLSX Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <!-- Chart.js für Advanced Dashboard -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    
    <!-- Zusätzliche Head-Inhalte -->
    {% block head %}{% endblock %}
    
    <!-- Mobile & Responsive Styles -->
    <style>
        /* Mobile Optimierungen */
        @media (max-width: 768px) {
            /* Touch-Targets vergrößern */
            button, a, input, select, textarea {
                min-height: 44px;
                min-width: 44px;
            }
            
            /* Mobile Navigation */
            .mobile-nav {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background: white;
                border-top: 1px solid #e5e7eb;
                z-index: 50;
                padding: 0.5rem;
            }
            
            /* Mobile Menu Toggle */
            .mobile-menu-toggle {
                display: block;
            }
            
            .desktop-nav {
                display: none;
            }
            
            /* Mobile Charts */
            .chart-container {
                height: 300px !important;
                overflow-x: auto;
            }
            
            /* Mobile Tables */
            .mobile-table {
                font-size: 0.875rem;
            }
            
            .mobile-table th,
            .mobile-table td {
                padding: 0.5rem 0.25rem;
            }
            
            /* Mobile Forms */
            .mobile-form input,
            .mobile-form select,
            .mobile-form textarea {
                font-size: 16px; /* Verhindert Zoom auf iOS */
                padding: 0.75rem;
            }
            
            /* Mobile Cards */
            .mobile-card {
                margin-bottom: 1rem;
                border-radius: 0.5rem;
            }
            
            /* Mobile Buttons */
            .mobile-btn {
                width: 100%;
                padding: 0.75rem 1rem;
                font-size: 1rem;
                border-radius: 0.5rem;
            }
            
            /* Mobile Grid */
            .mobile-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            /* Mobile Sidebar */
            .mobile-sidebar {
                position: fixed;
                top: 0;
                left: -100%;
                width: 80%;
                height: 100vh;
                background: white;
                z-index: 100;
                transition: left 0.3s ease;
                overflow-y: auto;
            }
            
            .mobile-sidebar.active {
                left: 0;
            }
            
            /* Mobile Overlay */
            .mobile-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 99;
                display: none;
            }
            
            .mobile-overlay.active {
                display: block;
            }
        }
        
        /* Tablet Optimierungen */
        @media (min-width: 769px) and (max-width: 1024px) {
            .tablet-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .tablet-chart {
                height: 400px;
            }
        }
        
        /* Touch-Gesten */
        .touch-swipe {
            touch-action: pan-y pinch-zoom;
        }
        
        .touch-scroll {
            -webkit-overflow-scrolling: touch;
        }
        
        /* Schlichte Fallback-Icons für kritische Elemente */
        .fa-user::before { content: "👤"; }
        .fa-sign-out-alt::before { content: "🚪"; }
        .fa-dashboard::before { content: "📊"; }
        .fa-project-diagram::before { content: "📋"; }
        .fa-users::before { content: "👥"; }
        .fa-database::before { content: "🗄️"; }
        .fa-calculator::before { content: "🧮"; }
        .fa-chart-line::before { content: "📈"; }
        .fa-plus::before { content: "➕"; }
        .fa-edit::before { content: "✏️"; }
        .fa-eye::before { content: "👁️"; }
        .fa-trash::before { content: "🗑️"; }
        .fa-cogs::before { content: "⚙️"; }
        .fa-times::before { content: "❌"; }
        .fa-check::before { content: "✅"; }
        .fa-spinner::before { content: "🔄"; }
        .fa-chevron-down::before { content: "🔽"; }
        .fa-chevron-up::before { content: "🔼"; }
        .fa-calendar::before { content: "📅"; }
        .fa-map-marker-alt::before { content: "📍"; }
        .fa-battery-half::before { content: "🔋"; }
        .fa-solar-panel::before { content: "☀️"; }
        .fa-wind::before { content: "💨"; }
        .fa-water::before { content: "💧"; }
        .fa-euro-sign::before { content: "💶"; }
        .fa-cog::before { content: "⚙️"; }
        .fa-chart-bar::before { content: "📊"; }
        .fa-file-upload::before { content: "📤"; }
        .fa-file-download::before { content: "📥"; }
        .fa-cloud::before { content: "☁️"; }
        .fa-flag::before { content: "🏁"; }
        .fa-bolt::before { content: "⚡"; }
        .fa-star::before { content: "⭐"; }
        .fa-home::before { content: "🏠"; }
        .fa-search::before { content: "🔍"; }
        .fa-arrow-left::before { content: "⬅️"; }
        .fa-arrow-right::before { content: "➡️"; }
        .fa-arrow-up::before { content: "⬆️"; }
        .fa-arrow-down::before { content: "⬇️"; }
        .fa-sync::before { content: "🔄"; }
        .fa-save::before { content: "💾"; }
        .fa-download::before { content: "📥"; }
        .fa-upload::before { content: "📤"; }
        .fa-link::before { content: "🔗"; }
        .fa-lock::before { content: "🔒"; }
        .fa-unlock::before { content: "🔓"; }
        .fa-bell::before { content: "🔔"; }
        .fa-envelope::before { content: "✉️"; }
        .fa-phone::before { content: "📞"; }
        .fa-server::before { content: "🖥️"; }
        .fa-wifi::before { content: "📶"; }
        .fa-bars::before { content: "☰"; }
        .fa-list::before { content: "📋"; }
        .fa-copy::before { content: "📋"; }
        .fa-undo::before { content: "↶"; }
        .fa-redo::before { content: "↷"; }
        .fa-expand::before { content: "⤢"; }
        .fa-compress::before { content: "⤡"; }
        .fa-times-circle::before { content: "❌"; }
        .fa-check-circle::before { content: "✅"; }
        .fa-exclamation-triangle::before { content: "⚠️"; }
        .fa-info-circle::before { content: "ℹ️"; }
        .fa-question-circle::before { content: "❓"; }
        .fa-minus::before { content: "➖"; }
        .fa-circle::before { content: "●"; }
        .fa-circle-notch::before { content: "🔄"; }
        .fa-gear::before { content: "⚙️"; }
        .fa-sliders-h::before { content: "🎛️"; }
        .fa-toggle-on::before { content: "🔘"; }
        .fa-toggle-off::before { content: "⚪"; }
    </style>
</head>
<body class="bg-gray-100">
    {% include 'header_simple.html' %}

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        {% block content %}{% endblock %}
    </main>

    {% include 'footer.html' %}
</body>
</html> 